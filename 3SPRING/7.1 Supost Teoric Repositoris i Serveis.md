---
title: 7.1- Exercicis Repositoris i Serveis. 
parent: 7.- Serveis.

has_children: true
layout: default
nav_order: 10
---

## Activitats Repositoris i Serveis a Spring Boot


* Totes les activitats es poden resoldre utilitzant **exclusivament els apunts proporcionats**.
* No es valoraran respostes copiades literalment dels apunts.
* Es valorarà especialment:

  * la capacitat de raonar,
  * l’ús correcte del vocabulari tècnic,
  * la justificació de les decisions.

---

### Activitat 1 — Investigació sobre el paper del repositori (nivell mitjà)

Un repositori en Spring Data JPA permet accedir a la base de dades sense escriure SQL manualment.

**Tasques:**

a) Explica amb les teues paraules quin és el **paper principal** d’un repositori dins d’una aplicació Spring Boot.

b) Justifica per què els repositoris **no haurien de contindre lògica de negoci**, encara que tècnicament siga possible.

c) Analitza quins problemes podrien aparéixer en un projecte si els repositoris començaren a prendre decisions de negoci.

---

### Activitat 2 — Investigació comparativa de tipus de repositoris (nivell mitjà)

Spring Data ofereix diferents interfícies de repositori, com `CrudRepository` i `JpaRepository`.

**Tasques:**

a) Investiga quines funcionalitats bàsiques comparteixen totes dues interfícies.

b) Explica quines funcionalitats addicionals aporta `JpaRepository` respecte a `CrudRepository`.

c) Raona en quin tipus de projecte seria suficient utilitzar `CrudRepository` i per què, i en quin altre seria més adequat `JpaRepository`.

---

### Activitat 3 — Investigació sobre convencions de noms (nivell mitjà-alt)

Les convencions de noms permeten definir consultes sense escriure SQL ni JPQL.

**Tasques:**

a) Explica com interpreta Spring Data JPA el nom d’un mètode com
`findByPaisAndPoblacioGreaterThan`.

b) Raona per què aquest mecanisme simplifica el desenvolupament de l’aplicació.

c) Analitza en quin moment l’ús de convencions de noms pot deixar de ser recomanable i per què seria millor utilitzar `@Query`.

---

### Activitat 4 — Investigació sobre la necessitat de la capa servei (nivell mitjà)

En una aplicació Spring Boot, els controladors no haurien d’accedir directament als repositoris.

**Tasques:**

a) Investiga quin és el **paper de la capa servei** entre el controlador i el repositori.

b) Justifica per què, encara que un servei només cride a un mètode del repositori, continua tenint sentit mantindre aquesta capa.

c) Analitza dos avantatges clars que aporta aquesta separació de capes en projectes reals.

---

### Activitat 5 — Investigació sobre el cicle de vida dels serveis (nivell mitjà-alt)

Spring permet executar codi en moments concrets del cicle de vida d’un servei.

**Tasques:**

a) Explica quan s’executen els mètodes anotats amb `@PostConstruct` i `@PreDestroy`.

b) Investiga quin tipus de tasques són adequades per a aquestes anotacions segons els apunts.

c) Raona per què no és correcte utilitzar `@PostConstruct` o `@PreDestroy` per implementar lògica de negoci habitual.

---

### Activitat 6 — Investigació sobre serveis compostos i transaccions (nivell avançat)

Un servei pot dependre d’altres serveis o repositoris per realitzar operacions més complexes.

**Tasques:**

a) Explica què s’entén per **servei compost** i quin avantatge aporta respecte a un servei senzill.

b) Analitza un cas en què un servei realitza diverses operacions sobre la base de dades i una d’elles falla. Quins problemes poden aparéixer?

c) Investiga com l’ús de `@Transactional` ajuda a garantir la coherència de les dades i justifica per què aquesta anotació ha d’estar a la capa servei.

---

### Activitat 7 — Investigació crítica sobre disseny i mantenibilitat (nivell avançat)

Es disposa d’una aplicació Spring Boot que ha crescut amb el temps. Inicialment només gestionava consultes simples, però amb el pas del temps s’han afegit més funcionalitats.

En aquesta aplicació:

* Els controladors accedeixen directament als repositoris.
* Alguns repositoris contenen mètodes amb lògica de negoci.
* Alguns serveis només existeixen per encapsular una única crida al repositori.

**Tasques:**

a) Analitza quins problemes de mantenibilitat i organització poden aparéixer amb aquest disseny.

b) Investiga com ajudaria una separació clara entre controladors, serveis i repositoris a millorar l’estructura del projecte.

c) Justifica quins canvis de disseny proposaries per fer l’aplicació més escalable i fàcil de mantenir, basant-te exclusivament en els apunts.

---

### Activitat 8 — Investigació avançada sobre coherència i responsabilitats (nivell avançat)

Un servei realitza diverses operacions que impliquen diferents repositoris i serveis.

En una situació concreta:

* Una operació d’eliminació s’executa correctament.
* La següent operació falla per una excepció.
* No s’ha definit cap transacció.

**Tasques:**

a) Investiga quines conseqüències pot tindre aquesta situació sobre la coherència de les dades.

b) Analitza per què la responsabilitat de gestionar aquesta situació no hauria de recaure en els repositoris de manera individual.

c) Justifica, amb arguments tècnics, per què la gestió de la transacció ha d’estar centralitzada a la capa servei i no dispersa en diferents repositoris.
