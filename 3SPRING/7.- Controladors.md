---
title: 7.- Controladors. 
parent: SPRING

has_children: true
layout: default
nav_order: 70
---

# **Controladors a Spring Boot**

Els **controladors** són un dels components fonamentals en una aplicació Spring Boot. Actuen com la capa que rep les peticions dels usuaris (HTTP), les processa i torna una resposta adequada, ja siga en forma de dades (JSON, XML) o de pàgines HTML.

---

### **1. Què és un controlador?**

Un **controlador** és una classe Java que:
- Gestiona les peticions que arriben des del client (navegador web, aplicacions mòbils, etc.).
- Utilitza els **serveis** per accedir a la lògica de negoci.
- Retorna dades al client en format JSON/XML o renderitza una pàgina HTML.

Spring Boot ofereix dos tipus principals de controladors:
1. **Controladors REST `@RestController`**:Quan volem exposar dades en format JSON o XML, ideals per a aplicacions frontend o mòbils.
2. **Controladors MVC `@Controller`**: Quan vols retornar pàgines HTML renderitzades al servidor, utilitzant motors de plantilles com Thymeleaf.

---

### **2. Components dels controladors**

Els controladors utilitzen diverses **anotacions** per definir les rutes, gestionar les peticions i processar les respostes.

**

### **1. `@Controller`**
- Marca una classe com un controlador que genera **respostes HTML** utilitzant un motor de plantilles (com Thymeleaf).
- Indica que aquesta classe forma part de la capa de presentació.

**Exemple:**
```java
@Controller
@RequestMapping("/localitzacions") // Defineix una ruta base
public class LocalitzacioMvcController {
    // Aquesta classe gestionarà les peticions a "/localitzacions"
}
```

---

### **2. `@RestController`**
- Una variant de `@Controller` que retorna directament **dades** en format JSON o XML, en lloc de generar pàgines HTML.
- Combina `@Controller` i `@ResponseBody`.

**Exemple:**
```java
@RestController
@RequestMapping("/api/localitzacions") // Defineix una ruta base per a l'API
public class LocalitzacioController {
    // Aquesta classe gestionarà les peticions a "/api/localitzacions"
}
```

---

### **3. `@RequestMapping`**
- Assigna una ruta base a una classe o mètode.
- Accepta diferents tipus de peticions HTTP (GET, POST, PUT, DELETE, etc.).

**Exemple:**
```java
@Controller
@RequestMapping("/localitzacions") // Ruta base
public class LocalitzacioMvcController {
    @RequestMapping("/paisos") // Ruta específica per aquest mètode
    public String veurePaisos() {
        return "paisos"; // Retorna la plantilla HTML "paisos.html"
    }
}
```

---

### **4. `@GetMapping`, `@PostMapping`, etc.**
- Variants especialitzades de `@RequestMapping` per especificar directament el tipus de petició HTTP.

**Exemple:**
```java
@GetMapping("/paisos") // Per gestionar peticions GET
public List<Pais> obtenirPaisos() {
    return paisService.obtenirTotsElsPaisos(); // Retorna una llista de països en JSON
}
```

---

### **5. `@RequestParam`**
- Captura els paràmetres de consulta enviats en la URL.

**Exemple:**
```java
@GetMapping("/provincies")
public List<Provincia> obtenirProvincies(@RequestParam String nomPais) {
    return provinciaService.obtenirProvinciesPerPais(nomPais); // Filtra per nom del país
}
```

---

### **6. `Model` (per a controladors MVC)**
- Utilitza el model per passar dades des del controlador a la plantilla HTML.

**Exemple:**
```java
@GetMapping("/paisos")
public String veurePaisos(Model model) {
    model.addAttribute("paisos", paisService.obtenirTotsElsPaisos()); // Afegeix dades al model
    return "paisos"; // Retorna la plantilla "paisos.html"
}
```

---

## **3. Tipus de controladors**

### **3.1. Controladors REST**
- Són ideals per a APIs que han d’exposar dades en format JSON o XML.
- S’utilitzen principalment per comunicar-se amb aplicacions frontend o mòbils.

#### **Exemple de controlador REST**
```java
@RestController
@RequestMapping("/api/localitzacions")
public class LocalitzacioController {

    @Autowired
    private PaisService paisService;

    @GetMapping("/paisos")
    public List<Pais> obtenirPaisos() {
        return paisService.obtenirTotsElsPaisos(); // Retorna la llista de països en JSON
    }
}
```

---

### **3.2. Controladors MVC**
- Són útils per generar pàgines HTML renderitzades amb motors de plantilles com Thymeleaf.
- Permeten passar dades a les plantilles mitjançant l’objecte `Model`.

#### **Exemple de controlador MVC**
```java
@Controller
@RequestMapping("/localitzacions")
public class LocalitzacioMvcController {

    @Autowired
    private PaisService paisService;

    @GetMapping("/paisos")
    public String veurePaisos(Model model) {
        model.addAttribute("paisos", paisService.obtenirTotsElsPaisos()); // Afegeix dades al model
        return "paisos"; // Retorna la plantilla "paisos.html"
    }
}
```

---

## **4. Exemple complet**

### **Repositori:**
```java
@Repository
public interface PaisRepository extends JpaRepository<Pais, Long> {
    List<Pais> findByNomContaining(String partNom); // Cerca països pel nom parcial
}
```

---

### **Servei:**
```java
@Service
public class PaisService {
    @Autowired
    private PaisRepository paisRepository;

    public List<Pais> obtenirTotsElsPaisos() {
        return paisRepository.findAll(); // Retorna tots els països
    }
}
```

---

### **Controlador REST:**
```java
@RestController
@RequestMapping("/api/localitzacions")
public class LocalitzacioController {
    @Autowired
    private PaisService paisService;

    @GetMapping("/paisos")
    public List<Pais> obtenirPaisos() {
        return paisService.obtenirTotsElsPaisos(); // Retorna la llista de països
    }
}
```

---

### **Controlador MVC:**
```java
@Controller
@RequestMapping("/localitzacions")
public class LocalitzacioMvcController {
    @Autowired
    private PaisService paisService;

    @GetMapping("/paisos")
    public String veurePaisos(Model model) {
        model.addAttribute("paisos", paisService.obtenirTotsElsPaisos()); // Afegeix dades al model
        return "paisos"; // Retorna la plantilla HTML "paisos.html"
    }
}
```

---

### **Plantilla HTML Thymeleaf (paisos.html):**
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Llista de Països</title>
</head>
<body>
    <h1>Llista de països</h1>
    <ul>
        <li th:each="pais : ${paisos}" th:text="${pais.nom}"></li>
    </ul>
</body>
</html>
```

---

## **5. Resum**

| **Tipus de controlador**   | **Propòsit**                                                                 |
|----------------------------|-----------------------------------------------------------------------------|
| **Controladors REST**      | Exposen dades en format JSON o XML. S’utilitzen principalment per a APIs.   |
| **Controladors MVC**       | Renderitzen pàgines HTML utilitzant motors de plantilles com Thymeleaf.     |

---

Amb aquesta estructura, els controladors gestionen la presentació i l’accés a les dades de manera clara i modular, permetent una separació neta entre les diferents capes de l’aplicació.