
### Exemple basat en l'exercici anterior:

En l'exercici anterior, la classe `Emp` té el següent camp declarat:

```java
private static final long serialversionUID = 129348938L;
```

Este **`serialVersionUID`** garanteix que, quan es deserialitze l'objecte, es comprove si l'objecte desat (el que es va serialitzar) és compatible amb la classe actual (la que deserialitza). Si el valor de **`serialVersionUID`** és diferent entre les dues versions, es produeix una excepció.

### Per què és important el serialVersionUID?

Quan es modifica una classe, com per exemple afegint o eliminant atributs, això pot afectar el procés de deserialització. Si es canvia la definició de la classe però no es defineix un **`serialVersionUID`** explícit, Java generarà automàticament un valor basat en la definició de la classe. Això vol dir que si la definició canvia, el **`serialVersionUID`** generat també canviarà, i els objectes desats amb la versió antiga de la classe no es podran deserialitzar amb la nova versió, donant lloc a una **`InvalidClassException`**.

Definir el **`serialVersionUID`** manualment ajuda a mantenir la compatibilitat entre diferents versions d'una classe serialitzable.

### Exemple de classe sense serialVersionUID:

```java

class Emp implements Serializable {
    int a;
    static int b;
    String name;
    int age;

    public Emp(String name, int age, int a, int b) {
        this.name = name;
        this.age = age;
        this.a = a;
        this.b = b;
    }
}
```

En aquest cas, si modifiquem la classe `Emp` afegint nous camps i intentem deserialitzar un objecte creat amb la versió antiga, obtindrem una **`InvalidClassException`** perquè el **`serialVersionUID`** generat automàticament per Java no coincidirà amb el de la nova versió.

### Exemple d'excepció:

```java

Exception in thread "main" java.io.InvalidClassException: Emp; local class incompatible: 
stream classdesc serialVersionUID = 123456789, local class serialVersionUID = 987654321
```

Esta excepció indica que els valors del **`serialVersionUID`** de la classe deserialitzada i de la classe local no coincideixen.

---

### Com assignar un serialVersionUID?

1. **Assignació manual**: Pots definir un **`serialVersionUID`** manualment per assegurar que la classe manté la compatibilitat entre diferents versions.

   Exemple:

   ```java

   class Emp implements Serializable {
       private static final long serialVersionUID = 129348938L;
       int a;
       static int b;
       String name;
       int age;

       public Emp(String name, int age, int a, int b) {
           this.name = name;
           this.age = age;
           this.a = a;
           this.b = b;
       }
   }
   ```

2. **Generació automàtica**: Si no es defineix el **`serialVersionUID`**, Java en genera un automàticament basant-se en els atributs, mètodes, modificadors, etc. de la classe. Això no és recomanable si la classe està subjecta a modificacions, ja que podria trencar la compatibilitat en futures deserialitzacions.

---

### Quan utilitzar un serialVersionUID?

- **Sempre que una classe sigua serialitzable**, és recomanable definir un **`serialVersionUID`**. Això proporciona control sobre la compatibilitat entre diferents versions de la classe.
- És especialment important quan tens l'objectiu de mantenir la compatibilitat entre versions del programari en què els objectes serialitzats poden viatjar a través de diferents versions de la mateixa aplicació.

---

### En Resum:

- El **`serialVersionUID`** és un identificador de versió únic per a una classe serialitzable.
- Assegura la compatibilitat entre la classe serialitzada i la deserialitzada.
- Si no es defineix manualment, Java en genera un automàticament, cosa que pot provocar incompatibilitats si es modifica la classe.
- Definir un **`serialVersionUID`** manualment ajuda a evitar problemes de deserialització quan es fan canvis a la classe.

### Exemple de deserialització fallida sense serialVersionUID:

Si afegíssim un nou camp a la classe `Emp` sense definir un **`serialVersionUID`**, un objecte creat amb la versió anterior de la classe llançaria una excepció quan intentem deserialitzar-lo:

```java

class Emp implements Serializable {
    
    private static final long serialVersionUID = 129348938L;
    transient int a;
    static int b;
    String name;
    int age;
    // Nou camp afegit
    String address;
}
```

Quan intentem deserialitzar un objecte creat amb la versió antiga de `Emp`, si no hem definit un **`serialVersionUID`** consistent, obtindrem una **`InvalidClassException`**.

---

Definir i gestionar correctament el **`serialVersionUID`** és una pràctica essencial per garantir la compatibilitat entre versions de classes serialitzables, especialment quan s'espera que les dades serialitzades es facen servir a llarg termini o es comparteixen entre versions diferents d'una aplicació.



